Adapted from https://reslp.github.io/blog/My-MAKER-Pipeline/

We will now train the second gene predictor AUGUSTUS.
First follow maker_after_round1.txt till you have the export.ann and export.dna files

convert SNAP ZFF files to GBK files.
script available here: GitHub page: https://github.com/hyphaltip/genome-scripts/blob/master/gene_prediction/zff2augustus_gbk.pl

The script needs to be run in the directory containing the export.ann and export.dna files.

> module load bioinfo-tools
> module load maker
> module load augustus

> chmod +x ./zff2augustus_gbk.pl
> cpan Bio::DB::Fasta
> ./zff2augustus_gbk.pl > augustus.gbk

we will split the now created augustus.gbk file into a training and a test set:

for the paper data I had 28 genes (counted with grep "LOCUS" augustus.gbk| wc -l)

> perl randomSplit.pl augustus.gbk 14

(randomSplit.pl comes with AUGUSTUS and is located in the scripts folder.)

We now have to create a new species for our AUGUSTUS training

> new_species.pl --species=mnatalensis #--didn't work


(this script is also located in the AUGUSTUS/scripts directory)

Lets now train AUGUSTUS with the training set file, evaluate the training and save the output of this test to a file for later reference:

## > etraining --species=mnatalensis augustus.gbk.train
> etraining --species=human augustus.gbk.train

##> augustus --species=mnatalensis augustus.gbk.test | tee first_training.out
> augustus --species=human augustus.gbk.test | tee first_training.out

Once this is done, we are ready to improve prediction parameters of the models using the optimize_augustus.pl script again located in the AUGUSTUS/scripts directory:

> mkdir config
> cp -r /sw/apps/bioinfo/augustus/3.2.3/rackham/config/* config/
> chmod -R 0777 species/human/

> optimize_augustus.pl --species=human augustus.gbk.train --AUGUSTUS_CONFIG_PATH=config



After this is done (this will take some time!) we can retrain and test AUGUSTUS with the optimized paramters and compare the results to the first run:

> etraining --species=human augustus.gbk.train --AUGUSTUS_CONFIG_PATH=config
> augustus --species=human augustus.gbk.test --AUGUSTUS_CONFIG_PATH=config| tee second_training.out


### TO RUN MAKER AGAIN ###
add to the maker_opst.ctl:
> augustus_species=human
> keep_preds=1

add to the run_maker.sh (before the maker command)
> export AUGUSTUS_CONFIG_PATH="/home/carolpb/GenomeAnalysis/results/6_Maker2_paper/run_1/sel2_NW_015504334_unziped.maker.output/config"



After it's done check if there are any errors:

> less sel2_NW_015504334_unziped_master_datastore_index.log

It should show:

NW_015504334.1  sel2_NW_015504334_unziped_datastore/88/48/NW_015504334.1/       STARTED
NW_015504334.1  sel2_NW_015504334_unziped_datastore/88/48/NW_015504334.1/       FINISHED
